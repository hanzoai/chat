import{j as e,r as s,et as a,eI as t,eJ as l,cQ as n,eK as r,ea as i,da as o,bD as c,bC as d,ei as m,cu as x,cw as u,cx as h,eL as p,eM as g}from"./vendor.hYViCx_o.js";import{b as v,Q as j,e as f,c as _,a as w,f as N,h as C,i as b,j as y,k,P as S,l as M,m as A,n as z,o as F,G as O,D as R,U as E,p as L,C as T,q as I,r as P,s as D,t as H,v as V,A as B,w as Z,x as $,y as W,z as K,E as U,F as q,H as G,I as Q,J,K as X,L as Y,M as ee,O as se,N as ae,R as te,d as le,S as ne,V as re,W as ie,X as oe,Y as ce,Z as de,_ as me,$ as xe,a0 as ue,a1 as he,a2 as pe,a3 as ge,a4 as ve,a5 as je,a6 as fe,a7 as _e,a8 as we,a9 as Ne}from"./index.ChtrlAPT.js";import"./utilities.D3AhyVZJ.js";import"./animations.C9kiQ0P7.js";import{al as Ce,ab as be,ac as ye,ad as ke,aD as Se,aE as Me,ag as Ae}from"./radix-ui.zUF2t8pu.js";import{b as ze,i as Fe,l as Oe,m as Re,n as Ee,j as Le,k as Te}from"./tanstack-vendor.CcfA9pap.js";import{z as Ie,L as Pe,F as De,q as He,c as Ve}from"./headlessui.CpNfReFM.js";import"./react-interactions.CDNIj_P0.js";import"./markdown_highlight.Dt5gy-Cs.js";import"./validation.CgW5gGeX.js";import"./math-katex.DxUdIsOj.js";import"./locales.CneDv1Po.js";import"./i18n.B6o-Gbrg.js";import"./routing.D6ZJbNew.js";import"./http-client.B1ynDCuQ.js";import"./date-utils.CHq2fTxU.js";import"./forms.CgWlvBRM.js";import"./framer-motion.BeyjVqYH.js";import"./advanced-inputs.oQ6kIoBT.js";import"./security-ui.MEypZJRJ.js";import"./markdown-processing.TTzZ1vwl.js";import"./avatars.zbie9GOZ.js";import"./virtualization.CzFJ0wKU.js";import"./heic-converter.CBfFuDy-.js";import"./sandpack.DtKLOr2o.js";import"./codemirror-core.K3HVILnM.js";import"./codemirror-state.ClnsKiKb.js";import"./codemirror-view.yuH3vRs8.js";import"./codemirror-language.B5LqEgWw.js";function Be(){return e.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"icon-md",children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15 5C14.4477 5 14 4.55228 14 4C14 3.44772 14.4477 3 15 3H20C20.5523 3 21 3.44772 21 4V9C21 9.55228 20.5523 10 20 10C19.4477 10 19 9.55228 19 9V6.41421L13.7071 11.7071C13.3166 12.0976 12.6834 12.0976 12.2929 11.7071C11.9024 11.3166 11.9024 10.6834 12.2929 10.2929L17.5858 5H15ZM4 7C4 5.34315 5.34315 4 7 4H10C10.5523 4 11 4.44772 11 5C11 5.55228 10.5523 6 10 6H7C6.44772 6 6 6.44772 6 7V17C6 17.5523 6.44772 18 7 18H17C17.5523 18 18 17.5523 18 17V14C18 13.4477 18.4477 13 19 13C19.5523 13 20 13.4477 20 14V17C20 18.6569 18.6569 20 17 20H7C5.34315 20 4 18.6569 4 17V7Z",fill:"currentColor"})})}function Ze(){return e.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"icon-sm",children:[e.jsx("path",{d:"M9 3H15M9 3V9.2759C9 9.74377 8.83597 10.1968 8.53644 10.5563L4.85085 14.979C4.30108 15.6387 4 16.4703 4 17.3291V17.3291C4 19.3565 5.64353 21 7.67094 21H16.3291C18.3565 21 20 19.3565 20 17.3291V17.3291C20 16.4703 19.6989 15.6387 19.1492 14.979L15.4636 10.5563C15.164 10.1968 15 9.74377 15 9.2759V3M9 3H8M15 3H16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M5 14.774C11.5 12.839 12.15 16.7089 18 14",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}function $e({className:s}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:_(s),children:[e.jsx("path",{d:"M2 10v3"}),e.jsx("path",{d:"M6 6v11"}),e.jsx("path",{d:"M10 3v18"}),e.jsx("path",{d:"M14 8v7"}),e.jsx("path",{d:"M18 5v13"}),e.jsx("path",{d:"M22 10v3"})]})}function We({className:s=""}){return e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:`icon-sm ${s}`,children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 4C10.3431 4 9 5.34315 9 7C9 8.65685 10.3431 10 12 10C13.6569 10 15 8.65685 15 7C15 5.34315 13.6569 4 12 4ZM7 7C7 4.23858 9.23858 2 12 2C14.7614 2 17 4.23858 17 7C17 9.76142 14.7614 12 12 12C9.23858 12 7 9.76142 7 7ZM19.0277 15.6255C18.6859 15.5646 18.1941 15.6534 17.682 16.1829C17.4936 16.3777 17.2342 16.4877 16.9632 16.4877C16.6922 16.4877 16.4328 16.3777 16.2444 16.1829C15.7322 15.6534 15.2405 15.5646 14.8987 15.6255C14.5381 15.6897 14.2179 15.9384 14.0623 16.3275C13.8048 16.9713 13.9014 18.662 16.9632 20.4617C20.0249 18.662 20.1216 16.9713 19.864 16.3275C19.7084 15.9384 19.3882 15.6897 19.0277 15.6255ZM21.721 15.5847C22.5748 17.7191 21.2654 20.429 17.437 22.4892C17.1412 22.6484 16.7852 22.6484 16.4893 22.4892C12.6609 20.4291 11.3516 17.7191 12.2053 15.5847C12.6117 14.5689 13.4917 13.8446 14.5481 13.6565C15.3567 13.5125 16.2032 13.6915 16.9632 14.1924C17.7232 13.6915 18.5697 13.5125 19.3783 13.6565C20.4347 13.8446 21.3147 14.5689 21.721 15.5847ZM9.92597 14.2049C10.1345 14.7163 9.889 15.2999 9.3776 15.5084C7.06131 16.453 5.5 18.5813 5.5 20.9999C5.5 21.5522 5.05228 21.9999 4.5 21.9999C3.94772 21.9999 3.5 21.5522 3.5 20.9999C3.5 17.6777 5.641 14.8723 8.6224 13.6565C9.1338 13.448 9.71743 13.6935 9.92597 14.2049Z",fill:"currentColor"})})}function Ke({hasMemoryOptOut:a,hasAnyPersonalizationFeature:t}){var l;const n=w(),{showToast:r}=N(),{data:i}=C(),[o,c]=s.useState(!0),d=b({onSuccess:()=>{r({message:n("com_ui_preferences_updated"),status:"success"})},onError:()=>{r({message:n("com_ui_error_updating_preferences"),status:"error"}),c(e=>!e)}});s.useEffect(()=>{var e;void 0!==(null==(e=null==i?void 0:i.personalization)?void 0:e.memories)&&c(i.personalization.memories)},[null==(l=null==i?void 0:i.personalization)?void 0:l.memories]);return t?e.jsx("div",{className:"flex flex-col gap-3 text-sm text-text-primary",children:a&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"border-b border-border-medium pb-3",children:e.jsx("div",{className:"text-base font-semibold",children:n("com_ui_memory")})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-2",children:n("com_ui_reference_saved_memories")}),e.jsx("div",{className:"mt-1 text-xs text-text-secondary",children:n("com_ui_reference_saved_memories_description")})]}),e.jsx(y,{checked:o,onCheckedChange:e=>{c(e),d.mutate({memories:e})},disabled:d.isLoading,"aria-label":n("com_ui_reference_saved_memories")})]})]})}):e.jsx("div",{className:"flex flex-col gap-3 text-sm text-text-primary",children:e.jsx("div",{className:"text-text-secondary",children:n("com_ui_no_personalization_available")})})}function Ue({open:n,onOpenChange:r}){var i,o;const c=A("(max-width: 767px)"),{data:d}=z(),m=w(),[x,u]=s.useState(F.GENERAL),h=s.useRef({}),{hasAnyPersonalizationFeature:p,hasMemoryOptOut:g}=function(){const e=k({permissionType:S.MEMORIES,permission:M.OPT_OUT});return{hasMemoryOptOut:e,hasAnyPersonalizationFeature:e}}(),v=[{value:F.GENERAL,icon:e.jsx(O,{}),label:"com_nav_setting_general"},{value:F.CHAT,icon:e.jsx(a,{className:"icon-sm"}),label:"com_nav_setting_chat"},{value:F.BETA,icon:e.jsx(Ze,{}),label:"com_nav_setting_beta"},{value:F.COMMANDS,icon:e.jsx(t,{className:"icon-sm"}),label:"com_nav_commands"},{value:F.SPEECH,icon:e.jsx($e,{className:"icon-sm"}),label:"com_nav_setting_speech"},...p?[{value:F.PERSONALIZATION,icon:e.jsx(We,{}),label:"com_nav_setting_personalization"}]:[],{value:F.DATA,icon:e.jsx(R,{}),label:"com_nav_setting_data"},...(null==(i=null==d?void 0:d.balance)?void 0:i.enabled)?[{value:F.BALANCE,icon:e.jsx(l,{size:18}),label:"com_nav_setting_balance"}]:[],{value:F.ACCOUNT,icon:e.jsx(E,{}),label:"com_nav_setting_account"}];return e.jsx(Ie,{appear:!0,show:n,children:e.jsxs(Pe,{as:"div",className:"relative z-50",onClose:r,children:[e.jsx(De,{enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black opacity-50 dark:opacity-80","aria-hidden":"true"})}),e.jsx(De,{enter:"ease-out duration-200",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-100",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsx("div",{className:_("fixed inset-0 flex w-screen items-center justify-center p-4"),children:e.jsxs(He,{className:_("min-h-[600px] overflow-hidden rounded-xl rounded-b-lg bg-background pb-6 shadow-2xl backdrop-blur-2xl animate-in sm:rounded-2xl md:min-h-[373px] md:w-[680px]"),children:[e.jsxs(Ve,{className:"mb-1 flex items-center justify-between p-6 pb-5 text-left",as:"div",children:[e.jsx("h2",{className:"text-lg font-medium leading-6 text-text-primary",children:m("com_nav_settings")}),e.jsxs("button",{type:"button",className:"rounded-sm opacity-70 transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-border-xheavy focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-surface-primary dark:focus:ring-offset-surface-primary",onClick:()=>r(!1),children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"h-5 w-5 text-text-primary",children:[e.jsx("line",{x1:"18",x2:"6",y1:"6",y2:"18"}),e.jsx("line",{x1:"6",x2:"18",y1:"6",y2:"18"})]}),e.jsx("span",{className:"sr-only",children:m("com_ui_close")})]})]}),e.jsx("div",{className:"max-h-[550px] overflow-auto px-6 md:max-h-[400px] md:min-h-[400px] md:w-[680px]",children:e.jsxs(Ce,{value:x,onValueChange:e=>{u(e)},className:"flex flex-col gap-10 md:flex-row",orientation:"vertical",children:[e.jsx(be,{"aria-label":"Settings",className:_("min-w-auto max-w-auto relative -ml-[8px] flex flex-shrink-0 flex-col flex-nowrap overflow-auto sm:max-w-none",c?"flex-row rounded-xl bg-surface-secondary":"sticky top-0 h-full"),onKeyDown:e=>{var s;const a=[F.GENERAL,F.CHAT,F.BETA,F.COMMANDS,F.SPEECH,...p?[F.PERSONALIZATION]:[],F.DATA,...(null==(s=null==d?void 0:d.balance)?void 0:s.enabled)?[F.BALANCE]:[],F.ACCOUNT],t=a.indexOf(x);switch(e.key){case"ArrowDown":e.preventDefault(),u(a[(t+1)%a.length]);break;case"ArrowUp":e.preventDefault(),u(a[(t-1+a.length)%a.length]);break;case"Home":e.preventDefault(),u(a[0]);break;case"End":e.preventDefault(),u(a[a.length-1])}},children:v.map(({value:s,icon:a,label:t})=>e.jsxs(ye,{className:_("group relative z-10 m-1 flex items-center justify-start gap-2 rounded-xl px-2 py-1.5 transition-all duration-200 ease-in-out",c?"flex-1 justify-center text-nowrap p-1 px-3 text-sm text-text-secondary radix-state-active:bg-surface-hover radix-state-active:text-text-primary":"bg-transparent text-text-secondary radix-state-active:bg-surface-tertiary radix-state-active:text-text-primary"),value:s,ref:e=>h.current[s]=e,children:[a,m(t)]},s))}),e.jsxs("div",{className:"overflow-auto sm:w-full sm:max-w-none md:pr-0.5 md:pt-0.5",children:[e.jsx(ke,{value:F.GENERAL,children:e.jsx(L,{})}),e.jsx(ke,{value:F.CHAT,children:e.jsx(T,{})}),e.jsx(ke,{value:F.BETA,children:e.jsx(I,{})}),e.jsx(ke,{value:F.COMMANDS,children:e.jsx(P,{})}),e.jsx(ke,{value:F.SPEECH,children:e.jsx(D,{})}),p&&e.jsx(ke,{value:F.PERSONALIZATION,children:e.jsx(Ke,{hasMemoryOptOut:g,hasAnyPersonalizationFeature:p})}),e.jsx(ke,{value:F.DATA,children:e.jsx(H,{})}),(null==(o=null==d?void 0:d.balance)?void 0:o.enabled)&&e.jsx(ke,{value:F.BALANCE,children:e.jsx(V,{})}),e.jsx(ke,{value:F.ACCOUNT,children:e.jsx(B,{})})]})]})})]})})})]})})}function qe({column:s,title:a,className:t="",filters:l,valueMap:i}){const o=w();return s.getCanSort()?e.jsx("div",{className:_("flex items-center space-x-2",t),children:e.jsxs(Z,{children:[e.jsx($,{asChild:!0,children:e.jsxs(W,{variant:"ghost",className:"px-2 py-0 text-xs hover:bg-surface-hover data-[state=open]:bg-surface-hover sm:px-2 sm:py-2 sm:text-sm",children:[e.jsx("span",{children:a}),s.getIsFiltered()?e.jsx(n,{className:"icon-sm ml-2 text-muted-foreground/70"}):e.jsx(n,{className:"icon-sm ml-2 opacity-30"}),(()=>{const a=s.getIsSorted();return"desc"===a?e.jsx(Se,{className:"icon-sm ml-2"}):"asc"===a?e.jsx(Me,{className:"icon-sm ml-2"}):e.jsx(Ae,{className:"icon-sm ml-2"})})()]})}),e.jsxs(K,{align:"start",className:"z-[1001] dark:border-gray-700 dark:bg-gray-850",children:[e.jsxs(U,{onClick:()=>s.toggleSorting(!1),className:"cursor-pointer text-text-primary",children:[e.jsx(Me,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),o("com_ui_ascending")]}),e.jsxs(U,{onClick:()=>s.toggleSorting(!0),className:"cursor-pointer text-text-primary",children:[e.jsx(Se,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),o("com_ui_descending")]}),e.jsx(q,{className:"dark:bg-gray-500"}),l&&Object.entries(l).map(([a,t])=>t.map(t=>{const l=null==i?void 0:i[t??""],r=null!=l&&l.length?o(l):String(t);return r?e.jsxs(U,{className:"cursor-pointer text-text-primary",onClick:()=>{s.setFilterValue(t)},children:[e.jsx(n,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),r]},`${a}-${t}`):null})),l&&e.jsxs(U,{className:s.getIsFiltered()?"cursor-pointer dark:text-white dark:hover:bg-gray-800":"pointer-events-none opacity-30",onClick:()=>{s.setFilterValue(void 0)},children:[e.jsx(r,{className:"mr-2 h-3.5 w-3.5 text-muted-foreground/70"}),o("com_ui_show_all")]})]})]})}):e.jsx("div",{className:_(t),children:a})}const Ge={[te.avatar]:"com_ui_avatar",[te.unknown]:"com_ui_unknown",[te.assistants]:"com_ui_assistants",[te.image_generation]:"com_ui_image_gen",[te.assistants_output]:"com_ui_assistants_output",[te.message_attachment]:"com_ui_attachment"},Qe=[{id:"select",header:({table:s})=>e.jsx(G,{checked:s.getIsAllPageRowsSelected()||s.getIsSomePageRowsSelected()&&"indeterminate",onCheckedChange:e=>s.toggleAllPageRowsSelected(!!e),"aria-label":"Select all",className:"flex"}),cell:({row:s})=>e.jsx(G,{checked:s.getIsSelected(),onCheckedChange:e=>s.toggleSelected(!!e),"aria-label":"Select row",className:"flex"}),enableSorting:!1,enableHiding:!1},{meta:{size:"150px"},accessorKey:"filename",header:({column:s})=>{const a=w();return e.jsxs(W,{variant:"ghost",className:"px-2 py-0 text-xs hover:bg-surface-hover sm:px-2 sm:py-2 sm:text-sm",onClick:()=>s.toggleSorting("asc"===s.getIsSorted()),children:[a("com_ui_name"),e.jsx(i,{className:"ml-2 h-3 w-4 sm:h-4 sm:w-4"})]})},cell:({row:s})=>{var a;const t=s.original;if(null==(a=t.type)?void 0:a.startsWith("image"))return e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Q,{url:t.filepath,className:"relative h-10 w-10 shrink-0 overflow-hidden rounded-md",source:t.source}),e.jsx("span",{className:"self-center truncate",children:t.filename})]});const l=J(t.type);return e.jsxs("div",{className:"flex gap-2",children:[l&&e.jsx(X,{fileType:l,className:"relative",file:t}),e.jsx("span",{className:"self-center truncate",children:t.filename})]})}},{accessorKey:"updatedAt",header:({column:s})=>{const a=w();return e.jsxs(W,{variant:"ghost",onClick:()=>s.toggleSorting("asc"===s.getIsSorted()),className:"px-2 py-0 text-xs hover:bg-surface-hover sm:px-2 sm:py-2 sm:text-sm",children:[a("com_ui_date"),e.jsx(i,{className:"ml-2 h-3 w-4 sm:h-4 sm:w-4"})]})},cell:({row:e})=>{var s;const a=A("(max-width: 768px)");return Y((null==(s=e.original.updatedAt)?void 0:s.toString())??"",a)}},{accessorKey:"filterSource",header:({column:s})=>{const a=w();return e.jsx(qe,{column:s,title:a("com_ui_storage"),filters:{Storage:Object.values(ee).filter(e=>e===ee.local||e===ee.openai||e===ee.azure)},valueMap:{[ee.azure]:"com_ui_azure",[ee.openai]:"com_ui_openai",[ee.local]:"com_ui_host"}})},cell:({row:s})=>{const a=w(),{source:t}=s.original;return t===ee.openai?e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(se,{className:"icon-sm text-black/50 dark:text-white/50"}),"OpenAI"]}):t===ee.azure?e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(ae,{className:"icon-sm text-cyan-700"}),"Azure"]}):e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(o,{className:"icon-sm text-cyan-700"}),a("com_ui_host")]})}},{accessorKey:"context",header:({column:s})=>{const a=w();return e.jsx(qe,{column:s,title:a("com_ui_context"),filters:{Context:Object.values(te).filter(e=>e===te[e??""])},valueMap:Ge})},cell:({row:s})=>{const{context:a}=s.original,t=w();return e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:t(Ge[a??te.unknown])})}},{accessorKey:"bytes",header:({column:s})=>{const a=w();return e.jsxs(W,{variant:"ghost",className:"px-2 py-0 text-xs hover:bg-surface-hover sm:px-2 sm:py-2 sm:text-sm",onClick:()=>s.toggleSorting("asc"===s.getIsSorted()),children:[a("com_ui_size"),e.jsx(i,{className:"ml-2 h-3 w-4 sm:h-4 sm:w-4"})]})},cell:({row:e})=>{const s=Number((Number(e.original.bytes)/1024/1024).toFixed(2));return s<.01?"< 0.01 MB":`${s} MB`}}],Je={[te.filename]:"com_ui_name",[te.updatedAt]:"com_ui_date",[te.filterSource]:"com_ui_storage",[te.context]:"com_ui_context",[te.bytes]:"com_ui_size"};function Xe({columns:a,data:t}){var l;const r=w(),[i,o]=s.useState(!1),d=c(le.filesByIndex(0)),{deleteFiles:m}=function(e){const s=ze(),a=v({onMutate:async e=>{const{files:s}=e;return s.length?{filesToDeleteMap:s.reduce((e,s)=>(e.set(s.file_id,s),e),new Map)}:new Map},onSuccess:(a,t,l)=>{console.log("Files deleted");const{filesToDeleteMap:n}=l;s.setQueryData([j.files],e=>{const{files:s}=t;return s.length?null==e?void 0:e.filter(e=>!n.has(e.file_id)):e}),null==e||e()},onError:s=>{console.log("Error deleting files:",s),null==e||e()}});return f({mutateAsync:a.mutateAsync})}(()=>o(!1)),[x,u]=s.useState({}),[h,p]=s.useState([]),g=A("(max-width: 768px)"),[N,C]=s.useState([]),[b,y]=s.useState({}),k=Fe({data:t,columns:a,onSortingChange:p,getCoreRowModel:Le(),getSortedRowModel:Ee(),onColumnFiltersChange:C,getFilteredRowModel:Re(),onColumnVisibilityChange:y,getPaginationRowModel:Oe(),onRowSelectionChange:u,state:{sorting:h,columnFilters:N,columnVisibility:b,rowSelection:x}});return e.jsxs("div",{className:"flex h-full flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 py-2 sm:gap-4 sm:py-4",children:[e.jsxs(W,{variant:"outline",onClick:()=>{o(!0);const e=k.getFilteredSelectedRowModel().rows.map(e=>e.original);m({files:e,setFiles:d}),u({})},disabled:!k.getFilteredSelectedRowModel().rows.length||i,className:_("min-w-[40px] transition-all duration-200",g&&"px-2 py-1"),children:[i?e.jsx(ne,{className:"size-3.5 sm:size-4"}):e.jsx(re,{className:"size-3.5 text-red-400 sm:size-4"}),!g&&e.jsx("span",{className:"ml-2",children:r("com_ui_delete")})]}),e.jsx(ie,{placeholder:r("com_files_filter"),value:(null==(l=k.getColumn("filename"))?void 0:l.getFilterValue())??"",onChange:e=>{var s;return null==(s=k.getColumn("filename"))?void 0:s.setFilterValue(e.target.value)},className:"flex-1 text-sm"}),e.jsxs(Z,{children:[e.jsx($,{asChild:!0,children:e.jsx(W,{variant:"outline",className:_("min-w-[40px]",g&&"px-2 py-1"),children:e.jsx(n,{className:"size-3.5 sm:size-4"})})}),e.jsx(K,{align:"end",className:"max-h-[300px] overflow-y-auto dark:border-gray-700 dark:bg-gray-850",children:k.getAllColumns().filter(e=>e.getCanHide()).map(s=>e.jsx(oe,{className:"cursor-pointer text-sm capitalize dark:text-white dark:hover:bg-gray-800",checked:s.getIsVisible(),onCheckedChange:e=>s.toggleVisibility(Boolean(e)),children:r(Je[s.id])},s.id))})]})]}),e.jsx("div",{className:"relative grid h-full max-h-[calc(100vh-20rem)] w-full flex-1 overflow-hidden overflow-x-auto overflow-y-auto rounded-md border border-black/10 dark:border-white/10",children:e.jsxs(ce,{className:"w-full min-w-[300px] border-separate border-spacing-0",children:[e.jsx(de,{className:"sticky top-0 z-50",children:k.getHeaderGroups().map(s=>e.jsx(me,{className:"border-b border-border-light",children:s.headers.map((s,a)=>{const t={};return 0===a&&"select"===s.id?(t.width="35px",t.minWidth="35px"):"filename"===s.id?t.width=g?"60%":"40%":t.width=g?"20%":"15%",e.jsx(xe,{className:"whitespace-nowrap bg-surface-secondary px-2 py-2 text-left text-sm font-medium text-text-secondary sm:px-4",style:{...t},children:s.isPlaceholder?null:Te(s.column.columnDef.header,s.getContext())},s.id)})},s.id))}),e.jsx(ue,{className:"w-full",children:k.getRowModel().rows.length?k.getRowModel().rows.map(s=>e.jsx(me,{"data-state":s.getIsSelected()&&"selected",className:"border-b border-border-light transition-colors hover:bg-surface-secondary [tr:last-child_&]:border-b-0",children:s.getVisibleCells().map((s,a)=>{var t;const l=(null==(t=s.column.columnDef.meta)?void 0:t.size)??"auto",n={};return"filename"===s.column.id?n.maxWidth=l:0===a&&(n.maxWidth="20px"),e.jsx(he,{className:"align-start overflow-x-auto px-2 py-1 text-xs sm:px-4 sm:py-2 sm:text-sm [tr[data-disabled=true]_&]:opacity-50",style:n,children:Te(s.column.columnDef.cell,s.getContext())},s.id)})},s.id)):e.jsx(me,{children:e.jsx(he,{colSpan:a.length,className:"h-24 text-center",children:r("com_files_no_results")})})})]})}),e.jsxs("div",{className:"flex items-center justify-end gap-2 py-4",children:[e.jsxs("div",{className:"ml-2 flex-1 truncate text-xs text-muted-foreground sm:ml-4 sm:text-sm",children:[e.jsx("span",{className:"hidden sm:inline",children:r("com_files_number_selected",{0:`${k.getFilteredSelectedRowModel().rows.length}`,1:`${k.getFilteredRowModel().rows.length}`})}),e.jsx("span",{className:"sm:hidden",children:`${k.getFilteredSelectedRowModel().rows.length}/${k.getFilteredRowModel().rows.length}`})]}),e.jsxs("div",{className:"flex items-center space-x-1 pr-2 text-xs font-bold text-text-primary sm:text-sm",children:[e.jsx("span",{className:"hidden sm:inline",children:r("com_ui_page")}),e.jsx("span",{children:k.getState().pagination.pageIndex+1}),e.jsx("span",{children:"/"}),e.jsx("span",{children:k.getPageCount()})]}),e.jsx(W,{className:"select-none",variant:"outline",size:"sm",onClick:()=>k.previousPage(),disabled:!k.getCanPreviousPage(),children:r("com_ui_prev")}),e.jsx(W,{className:"select-none",variant:"outline",size:"sm",onClick:()=>k.nextPage(),disabled:!k.getCanNextPage(),children:r("com_ui_next")})]})]})}function Ye({open:s,onOpenChange:a}){const t=w(),{data:l=[]}=pe({select:e=>e.map(e=>(e.context=e.context??te.unknown,e.filterSource=e.source===ee.firebase?ee.local:e.source,e))});return e.jsx(ge,{open:s,onOpenChange:a,children:e.jsxs(ve,{title:t("com_nav_my_files"),className:"w-11/12 bg-background text-text-primary shadow-2xl",children:[e.jsx(je,{children:e.jsx(fe,{children:t("com_nav_my_files")})}),e.jsx(Xe,{columns:Qe,data:l})]})})}ee.openai,ee.local,ee.local,ee.local;const es=s.memo(function(){var a,t;const l=w(),{user:n,isAuthenticated:r,logout:i}=_e(),{data:o}=z(),c=we({enabled:!!r&&(null==(a=null==o?void 0:o.balance)?void 0:a.enabled)}),[v,j]=s.useState(!1),[f,_]=d(le.showFiles),N=Ne(n),C=(null==n?void 0:n.avatar)||(null==n?void 0:n.name)||(null==n?void 0:n.username)||"";return e.jsxs(m,{children:[e.jsxs(x,{"aria-label":l("com_nav_account_settings"),"data-testid":"nav-user",className:"mt-text-sm flex h-auto w-full items-center gap-2 rounded-xl p-2 text-sm transition-all duration-200 ease-in-out hover:bg-surface-hover",children:[e.jsx("div",{className:"-ml-0.9 -mt-0.8 h-8 w-8 flex-shrink-0",children:e.jsx("div",{className:"relative flex",children:0===C.length?e.jsx("div",{style:{backgroundColor:"rgb(121, 137, 255)",width:"32px",height:"32px",boxShadow:"rgba(240, 246, 252, 0.1) 0px 0px 0px 1px"},className:"relative flex items-center justify-center rounded-full p-1 text-text-primary","aria-hidden":"true",children:e.jsx(E,{})}):e.jsx("img",{className:"rounded-full",src:((null==n?void 0:n.avatar)??"")||N,alt:`${(null==n?void 0:n.name)||(null==n?void 0:n.username)||(null==n?void 0:n.email)||""}'s avatar`})})}),e.jsx("div",{className:"mt-2 grow overflow-hidden text-ellipsis whitespace-nowrap text-left text-text-primary",style:{marginTop:"0",marginLeft:"0"},children:(null==n?void 0:n.name)??(null==n?void 0:n.username)??l("com_nav_user")})]}),e.jsxs(u,{className:"popover-ui w-[235px]",style:{transformOrigin:"bottom",marginRight:"0px",translate:"0px"},children:[e.jsx("div",{className:"text-token-text-secondary ml-3 mr-2 py-2 text-sm",role:"note",children:(null==n?void 0:n.email)??l("com_nav_user")}),e.jsx(q,{}),!0===(null==(t=null==o?void 0:o.balance)?void 0:t.enabled)&&null!=c.data&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-token-text-secondary ml-3 mr-2 py-2 text-sm",role:"note",children:[l("com_nav_balance"),":"," ",(new Intl.NumberFormat).format(Math.round(c.data.tokenCredits))]}),e.jsx(q,{})]}),e.jsxs(h,{value:"",onClick:()=>_(!0),className:"select-item text-sm",children:[e.jsx(p,{className:"icon-md","aria-hidden":"true"}),l("com_nav_my_files")]}),"/"!==(null==o?void 0:o.helpAndFaqURL)&&e.jsxs(h,{value:"",onClick:()=>window.open(null==o?void 0:o.helpAndFaqURL,"_blank"),className:"select-item text-sm",children:[e.jsx(Be,{"aria-hidden":"true"}),l("com_nav_help_faq")]}),e.jsxs(h,{value:"",onClick:()=>j(!0),className:"select-item text-sm",children:[e.jsx(O,{className:"icon-md","aria-hidden":"true"}),l("com_nav_settings")]}),e.jsx(q,{}),e.jsxs(h,{"aria-selected":!0,onClick:()=>i(),value:"logout",className:"select-item text-sm",children:[e.jsx(g,{className:"icon-md"}),l("com_nav_log_out")]})]}),f&&e.jsx(Ye,{open:f,onOpenChange:_}),v&&e.jsx(Ue,{open:v,onOpenChange:j})]})});export{es as default};

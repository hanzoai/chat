import{r as e,j as s,bE as a}from"./vendor.hYViCx_o.js";import{ay as t,az as r,aC as o}from"./radix-ui.zUF2t8pu.js";import{g as i,Q as n,S as c,u as l,a as m,d,T as u,c as j,B as p}from"./index.ChtrlAPT.js";import{u as x}from"./tanstack-vendor.CcfA9pap.js";import"./utilities.D3AhyVZJ.js";import"./animations.C9kiQ0P7.js";import{E as h,l as g,y as f,P as b}from"./headlessui.CpNfReFM.js";import"./react-interactions.CDNIj_P0.js";import"./markdown_highlight.Dt5gy-Cs.js";import"./validation.CgW5gGeX.js";import"./math-katex.DxUdIsOj.js";import"./locales.CneDv1Po.js";import"./i18n.B6o-Gbrg.js";import"./routing.D6ZJbNew.js";import"./http-client.B1ynDCuQ.js";import"./date-utils.CHq2fTxU.js";import"./forms.CgWlvBRM.js";import"./framer-motion.BeyjVqYH.js";import"./advanced-inputs.oQ6kIoBT.js";import"./security-ui.MEypZJRJ.js";import"./markdown-processing.TTzZ1vwl.js";import"./avatars.zbie9GOZ.js";import"./virtualization.CzFJ0wKU.js";import"./heic-converter.CBfFuDy-.js";import"./sandpack.DtKLOr2o.js";import"./codemirror-core.K3HVILnM.js";import"./codemirror-state.ClnsKiKb.js";import"./codemirror-view.yuH3vRs8.js";import"./codemirror-language.B5LqEgWw.js";const v=({tag:a,selected:o,handleSubmit:i,icon:n,...l})=>{const[m,d]=e.useState(!1);return s.jsx(h,{"aria-label":a,className:"group flex w-full gap-2 rounded-lg p-2.5 text-sm text-text-primary transition-colors duration-200 focus:outline-none data-[focus]:bg-surface-hover data-[focus-visible]:ring-2 data-[focus-visible]:ring-primary",...l,as:"button",onClick:async()=>{"New Bookmark"!==a?(d(!0),i(a),d(!1)):i()},children:s.jsx("div",{className:"flex grow items-center justify-between gap-2",children:s.jsxs("div",{className:"flex items-center gap-2",children:[null!=n?n:m?s.jsx(c,{className:"size-4"}):o?s.jsx(t,{className:"size-4"}):s.jsx(r,{className:"size-4"}),s.jsx("div",{style:{wordBreak:"break-word",overflowWrap:"anywhere"},children:a})]})})})},k=({tags:e,handleSubmit:a,header:t})=>{const{bookmarks:r}=l();return s.jsxs(s.Fragment,{children:[t,r.length>0&&s.jsx("div",{className:"my-1.5 h-px",role:"none"}),r.map((t,r)=>s.jsx(v,{tag:t.tag,selected:e.includes(t.tag),handleSubmit:a},`${t._id??t.tag}-${r}`))]})},y=({conversation:a,tags:t=[],setTags:r})=>{const[i,n]=e.useState(),{bookmarks:c}=l(),d=m();e.useEffect(()=>{i||n(a)},[a,i]);const u=()=>{r([])};return 0===c.length?s.jsxs("div",{className:"flex flex-col",children:[s.jsx(v,{tag:d("com_ui_clear_all"),"data-testid":"bookmark-item-clear",handleSubmit:u,selected:!1,icon:s.jsx(o,{className:"size-4"})}),s.jsx(v,{tag:d("com_ui_no_bookmarks"),"data-testid":"bookmark-item-no-bookmarks",handleSubmit:()=>Promise.resolve(),selected:!1,icon:"ðŸ¤”"})]}):s.jsx("div",{className:"flex flex-col",children:s.jsx(k,{tags:t,handleSubmit:e=>{if(void 0===e)return;const s=(e=>t.some(s=>s===e)?t.filter(s=>s!==e):[...t,e])(e);r(s)},header:s.jsx(v,{tag:d("com_ui_clear_all"),"data-testid":"bookmark-item-clear",handleSubmit:u,selected:!1,icon:s.jsx(o,{className:"size-4"})})})})},N=({tags:o,setTags:c,isSmallScreen:l})=>{const h=m(),{data:v}=x([n.conversationTags],()=>i(),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,...k});var k;const N=a(d.conversationByIndex(0)),w=e.useMemo(()=>o.length>0?o.join(", "):h("com_ui_bookmarks"),[o,h]);return s.jsx(g,{as:"div",className:"group relative",children:({open:e})=>s.jsxs(s.Fragment,{children:[s.jsx(u,{description:w,render:s.jsx(f,{id:"bookmark-menu-button","aria-label":h("com_ui_bookmarks"),className:j("flex items-center justify-center","size-10 border-none text-text-primary hover:bg-accent hover:text-accent-foreground","rounded-full border-none p-2 hover:bg-surface-hover md:rounded-xl",e?"bg-surface-hover":""),"data-testid":"bookmark-menu",children:o.length>0?s.jsx(t,{className:j("text-text-primary",l?"icon-md-heavy":"icon-lg"),"aria-hidden":"true"}):s.jsx(r,{className:j("text-text-primary",l?"icon-md-heavy":"icon-lg"),"aria-hidden":"true"})})}),s.jsx(b,{anchor:"bottom",className:"absolute left-0 top-full z-[100] mt-1 w-60 translate-y-0 overflow-hidden rounded-lg bg-surface-secondary p-1.5 shadow-lg outline-none",children:v&&N&&s.jsx(p.Provider,{value:{bookmarks:v.filter(e=>e.count>0)},children:s.jsx(y,{conversation:N,tags:o,setTags:c})})})]})})};export{N as default};
